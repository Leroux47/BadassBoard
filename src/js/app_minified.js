let contentHeight,iPlaylist=0,mousePosition={},owmToken="";$.ajax({url:"./settings/ip.txt",method:"GET"}).done(e=>{const t=io.connect(`http://${e}:8080`);$.ajax({url:"./settings/settings.json",method:"GET",dataType:"json"}).done(e=>{void 0!==e.backgroundImage&&$.ajax({url:e.backgroundImage,method:"GET",dataType:"",statusCode:{200:()=>{$("#backgroundImage").css("background-image",`url(${e.backgroundImage})`)},404:()=>{$("#msgContainer").text("Sorry, your background image couldn't be loaded... Maybe try another one"),i("#msgContainer")}}}),void 0!==e.owmToken&&(owmToken=e.owmToken,$(".owmToken__Comment").text(`Your OpenWeatherMap token is ${owmToken}. You can update it here !`))});const n=(e,n)=>{let s=`${e} ${n} .blank`;contentHeight=$(".content").height(),$(`${n} .rssContainer`).length||$(`${n} .forecast`).length||$(n).mouseenter(()=>{$(s).addClass("flex visible").removeClass("invisible")}).mouseleave(()=>{$(s).addClass("invisible").removeClass("visible")}),$(s).click(()=>{$(n).css("padding","0"),$(`${e} ${n} .addContent`).addClass("flex"),$(s).hide(),$(n).mouseenter(()=>{$(`${e} ${n} .addContent`).is(":visible")&&$(s).hide()}),$(`${e} ${n} .addContent`).ready(()=>{$(`${e} ${n} .addContent__select`).on("change",()=>{$(`${e} ${n} .addContent__btnContainer`).css("display","inline-flex"),"Add a feed"===$(`${e} ${n} .addContent__select`).val()?($(`${e} ${n} .addContent`).removeClass("menu"),$(`${e} ${n} .addContent__select`).addClass("select"),$(`${e} ${n} .addContent__feed`).css("display","").addClass("flex"),$(`${e} ${n} .addContent__weather:visible`).length&&$(`${e} ${n} .addContent__weather`).hide(),$(`${e} ${n} .addContent__submitBtn`).click(()=>{null!==$(`${e} ${n} .addContent__feed__input`).val()&&void 0!==$(`${e} ${n} .addContent__feed__input`).val()&&""!==$(`${e} ${n} .addContent__feed__input`).val()?t.emit("add content",[{element:n,parent:e,url:$(`${e} ${n} .addContent__feed__input`).val(),type:"rss",new:!1}]):r("Bad RSS feed URL"),l(),$(`${e} ${n} .addContent`).hide()})):"Weather forecast"===$(`${e} ${n} .addContent__select`).val()?($(`${e} ${n} .addContent`).removeClass("menu"),$(`${e} ${n} .addContent__select`).addClass("select"),$(`${e} ${n} .addContent__feed:visible`).length&&$(`${e} ${n} .addContent__feed`).hide(),$(`${e} ${n} .addContent__weather`).css({justifyContent:"center",alignItems:"center",display:""}).addClass("flex"),$(`${e} ${n} .addContent__submitBtn`).click(()=>{$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${$(`${e} ${n} .addContent__weather__input`).val()}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{a(n)},200:s=>{l(),t.emit("add content",[{element:n,parent:e,location:$(`${e} ${n} .addContent__weather__input`).val(),type:"weather",new:!1}])}}})})):($(`${e} ${n} .addContent`).addClass("menu"),$(`${e} ${n} .addContent__select`).removeClass("select"),$(`${e} ${n} .addContent__feed, ${e} ${n} .addContent__weather, ${e} ${n} .addContent__btnContainer`).hide())}),$(`${e} ${n} .addContent__cancelBtn`).click(()=>{$(`${e} ${n} .addContent`).hide(),$(s).show()})})})},s=e=>{contentHeight=$(".content").height();const s=(e,t,s)=>{$(t).length&&($(s).mouseenter(()=>{$(`${e} .contentOptions`).css("display","flex")}).mouseleave(()=>{$(`${e} .contentOptions`).hide()}),$(`${e} .removeContentBtn`).click(()=>{$(t).remove(),$(t).length||($(e).css({height:contentHeight}),$(`${e} .blank`).css({height:contentHeight}).addClass("flex")),n(`.${$(e).parent().attr("class").match(/content\d__container/)}`,`.${$(e).attr("class").match(/content\d{1,}/)}`)}))},o=(e,n,s)=>{$(n).length&&($(s).mouseenter(()=>{$(`${n} .contentOptions`).addClass("flex")}).mouseleave(()=>{$(`${n} .contentOptions`).hide()}),$(`${n} .updateContentBtn`).click(()=>{if(n.match(/rss/i))t.emit("update feed",{element:n}),t.on("rss parsed",e=>{console.log("update"),l(e.element)});else if(n.match(/forecast/i)){let t=$(".forecast__header__title").text().split(" ");t.splice(0,2),t=t[0],$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${t}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{a(e)},200:e=>{let t=e.list[0].weather[0].description.split(""),n=t[0].toUpperCase();t.shift(),t.unshift(n),t=t.join("");let s={temp:e.list[0].main.temp,city:e.list[0].name,description:t,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};$(".forecast__content__info__description__desc").text(s.description),$(".forecast__content__info__temp__desc").text(`${s.temp} °C`),$(".forecast__content__info__wind__desc").text(`${s.windSpeed} km/h`),$(".forecast__content__info__humidity__desc").text(`${s.humidity} %`),u(s)}}})}}))};$(`${e} .rssContainer`).ready(()=>{s(e,`${e} .rssContainer`,`${e} .rssContainer__header`),o(e,`${e} .rssContainer`,`${e} .rssContainer__header`)}),$(`${e} .forecast`).ready(()=>{s(e,`${e} .forecast`,`${e} .forecast__header`),o(e,`${e} .forecast`,`${e} .forecast__header`)})},o=e=>{let t=$("<b></b>");t.text(e).addClass("warning"),$("#backgroundImageUploadForm").after(t)},a=e=>{let t="Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.";if($(".addContent:visible").length){if(!$(".addContent .warning").length){$("<span></span>").addClass("warning").text(t).appendTo($(".addContent__weather"))}}else if(!$(`${e} .warning`).length){$("<span></span>").addClass("warning").css({marginTop:0,alignItems:"center"}).text(t).appendTo(e)}},i=e=>{$(e).fadeIn(2e3,()=>{setTimeout(()=>{$(e).fadeOut(2e3)},5e3)})},d=e=>{if($(".audio").addClass("flex"),$(".player__leftSvg, .player__rightSvg").off(),p(),void 0===e.videos[iPlaylist])r("Invalid playlist reference !");else if(iPlaylist<e.videoCount&&!e.videos[iPlaylist].title.match(/deleted video/gi)&&void 0!==e.videos[iPlaylist]){if($(".moreContent").height("60%"),$(".audio__player").length){if($("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),!$(".player__leftSvg").length){$('<svg class="player__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').hide().prependTo(".player"),$('<svg class="player__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').hide().appendTo(".player")}$(".streamInfoContainer, .player, .playlistInfo, .player__leftSvg, .player__rightSvg").show(),$(".playlistEndMsg").hide()}else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element :(").appendTo(".player"),$('<svg class="player__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').prependTo(".player"),$('<svg class="player__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').appendTo(".player"),$("<source>").attr({id:"audioSrc",src:`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`,type:" audio/mpeg"}).appendTo(".audio__player")}if($(".streamInfoContainer").length)if($("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$("streamInfoContainer").css({width:"90%"}),$(".playlistInfo").length)$(".playlistInfo").show().text(`${iPlaylist+1}/${e.videoCount}`);else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`).show().prependTo(".audioMsg")}else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`).show().prependTo(".audioMsg"),$("<span></span>").addClass("streamInfoContainer").css({width:"90%"}).insertBefore(".audio__remove"),$("<span></span>").attr("id","streamText").text("You're listening to ").appendTo(".streamInfoContainer"),$("<span></span>").attr("id","streamTitle").text(e.videos[iPlaylist].title).appendTo(".streamInfoContainer"),$("<span></span>").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`).attr("id","YtId").appendTo(".streamInfoContainer")}document.getElementById("audio__player").load(),document.getElementById("audio__player").onended=()=>{if(iPlaylist++,void 0!==e.videos[iPlaylist])d(e);else{if($(".player__rightSvg").hide(),$(".player, .streamInfoContainer, .playlistInfo").hide(),!$(".endOfPlaylist").length){$("<span></span>").text("There is no track left in here... 😭").addClass("playlistEndMsg").prependTo(".audioMsg")}$(".audioMsg").css("justify-content","center"),i($(".audio"))}},$(".audio__player").show(),$(".audioMsg").show(),$(".audio").fadeIn(1500),(e=>{void 0!==e.videos[iPlaylist]&&(iPlaylist<e.videoCount?(0===iPlaylist&&$(".player__leftSvg").hide(),$(".player__rightSvg").click(()=>{++iPlaylist<e.videoCount&&void 0!==e.videos[iPlaylist]&&($("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`),iPlaylist>0&&$(".player__leftSvg").show(),iPlaylist===e.videoCount-1&&$(".player__rightSvg").hide())}),$(".player__leftSvg").click(()=>{iPlaylist>0&&(iPlaylist--,$("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`)),0===iPlaylist?$(".player__leftSvg").hide():iPlaylist>0&&$(".player__rightSvg").show()})):$(".player__rightSvg").show())})(e)}else void 0===e.videos[iPlaylist]?r("Video ID not found !"):e.videos[iPlaylist].title.match(/(deleted video) || (private video)/gi)&&(iPlaylist++,d(e))},l=()=>{t.on("parse content",e=>{for(const[n,o]of e.entries()){const i=(e,t,n,s)=>{if($(t).length)s();else{let o=$("<div></div>").addClass(`content content${n}`).attr("id",`content${n}`);$(t).length||o.appendTo(e),$(t).ready(()=>{$(`${t} .blank`).length||$(`${t} .addContent`).length||$(t).prepend(_).append(h),s()})}};let d=o.parent,c=o.element,p=`${o.parent} ${o.element}`,g=Number(c.match(/[0-9]{1,}/)),_=$(".blank").clone()[0],h=$(".addContent").clone()[0];i(d,p,g,()=>{if($(p).off(),"weather"===o.type&&($(`${p} .forecast`).length||void 0!==o.location&&owmToken.match(/[a-z0-9]{32}/)&&$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${o.location}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{a(p)},200:e=>{e.cod;if(1===e.count){$(".addContent:visible").length&&$(".addContent").hide();let t=e.list[0].id,n=e.list[0].weather[0].description.split(""),o=n[0].toUpperCase();n.shift(),n.unshift(o),n=n.join("");let a={temp:e.list[0].main.temp,city:e.list[0].name,description:n,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};if(!$(`${p} .forecast`).length){let e=$("<section></section>");e.addClass("forecast flex").appendTo(p);let n=$("<span></span>");n.addClass("forecast__header").appendTo(e),$("<a></a>").addClass("forecast__header__title").text(`Weather in ${a.city}`).attr("href",`https://openweathermap.org/city/${t}`).appendTo(n);let o=$("<div></div>");o.addClass("forecast__content flex").appendTo(e);let i=$("<div></div>");i.addClass("forecast__content__info flex").appendTo(o);let d=$("<span></span>");d.addClass("forecast__content__info__desc").appendTo(i),$("<p></p>").addClass("forecast__content__info__description__desc flex").text(a.description).appendTo(d),$("<span></span>").addClass("forecastIcon").text("🛈").prependTo(d);let l=$("<span></span>");l.addClass("forecast__content__info__temp").appendTo(i),$("<p></p>").addClass("forecast__content__info__temp__desc flex").text(`${a.temp} °C`).appendTo(l),$("<span></span>").addClass("forecastIcon").text("🌡").prependTo(l);let r=$("<span></span>");r.addClass("forecast__content__info__wind").appendTo(i),$("<p></p>").addClass("forecast__content__info__wind__desc").text(`${a.windSpeed} km/h`).appendTo(r),$("<img>").addClass("forecastIcon").attr({alt:"wind icon",src:"./src/css/icons/interface/wind.svg"}).prependTo(r);let c=$("<span></span>");c.addClass("forecast__content__info__humidity").appendTo(i),$("<p></p>").addClass("forecast__content__info__humidity__desc flex").text(`${a.humidity} %`).appendTo(c),$("<span></span>").addClass("forecastIcon").text("💧").prependTo(c);let g=$("<div></div>");g.addClass("forecast__weatherIcon flex").appendTo(o),$("<span></span>").addClass("forecast__weatherIcon__icon").appendTo(g),u(a);let _=$("<span></span>");_.addClass("contentOptions").appendTo(n),$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./src/css/icons/interface/refresh.svg"}).appendTo(_),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./src/css/icons/interface/cross.svg"}).appendTo(_),s(p)}}else{let e="Sorry homie, it seems this location doesn't exist...";if($(".addContent:visible").length){if(!$(".addContent .warning").length){$("<span></span>").addClass("warning").text(e).appendTo($(".addContent__weather"))}}else if(!$(`${p} .warning`).length){$("<span></span>").addClass("warning").css({marginTop:0,alignItems:"center"}).text(e).appendTo(p)}}}}})),"rss"===o.type){let e=o.feed;const t=(e,t)=>{let n=$("<section></section>"),s=$("<div></div>");for(let t=0;t<10;t++)if(void 0!==e[t]&&void 0!==e[t].title&&void 0!==e[t].link){n.addClass("rssContainer flex"),s.addClass("linksContainer").appendTo(n);let o=$("<div></div>");o.addClass("article flex").appendTo(s),$("<a></a>").addClass("link").attr("href",e[t].link).text(e[t].title).appendTo(o),$("<div></div>").addClass("article__desc").append(e[t].summary).appendTo(s)}t(e,n)};$(`${p} .rssContainer`).length||t(e,(e,t)=>{t.appendTo(p);let n=$("<div></div>");n.addClass("rssContainer__header").prependTo(`${p} .rssContainer`),$("<a></a>").addClass("feedTitle").attr({href:e[0].meta.link}).text(e[0].meta.title).prependTo(`${p} .rssContainer__header`);let o=$("<span></span>");o.addClass("contentOptions").appendTo(n),$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./src/css/icons/interface/refresh.svg"}).appendTo(o),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./src/css/icons/interface/cross.svg"}).appendTo(o),$(`${p} .article`).mouseenter(e=>{e.currentTarget.className.match("article")&&($(e.currentTarget.nextElementSibling).clone().appendTo(".rssTooltip"),mousePosition.x<$(window).width()/100*30?$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x+$(window).width()/100*15}):$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x-$(window).width()/100*35}))}).mouseleave(e=>{$(".rssTooltip .article__desc").remove()}),s(p)})}d.match(g)||$(p).addClass("subRow"),setTimeout(()=>{if(!$(`${d} .newContent`).length){let e=$("<div></div>");e.addClass("newContent content subRow flex").appendTo(d).prepend(_).append(h);let n=$(`${d} .newContent .blank`);n.addClass("flex"),$(e).mouseenter(()=>{$(n).css({visibility:"visible"}).addClass("flex"),$(n).click(()=>{$(p).css("padding","0"),$(n).off().hide(),$(`${d} .newContent .addContent`).addClass("flex"),$(`${d} .newContent`).mouseenter(()=>{$(`${d} .newContent .addContent`).is(":visible")&&$(n).css({display:"none"})}),$(`${d} .newContent .addContent`).ready(()=>{let n;const s=()=>{n=Number(e.prev().attr("class").substring(15,16))+1,e.removeClass("newContent").addClass(`content${n}`)};$(`${d} .newContent .addContent__select`).on("change",()=>{$(`${d} .newContent .addContent__btnContainer`).css("display","inline-flex"),"Add a feed"===$(`${d} .newContent .addContent__select`).val()?($(`${d} .newContent .addContent`).removeClass("menu"),$(`${d} .newContent .addContent__select`).addClass("select"),$(`${d} .newContent .addContent__weather:visible`).length&&$(`${d} .newContent .addContent__weather`).hide(),$(`${d} .newContent .addContent__feed`).addClass("flex"),$(`${d} .newContent .addContent__submitBtn`).click(()=>{s(),$(`${d} .newContent .addContent`).hide(),null!==$(`${d} .content${n} .addContent__feed__input`).val()&&void 0!==$(`${d} .content${n} .addContent__feed__input`).val()&&""!==$(`${d} .newContent .addContent__feed__input`).val()?t.emit("add content",[{element:`.content${n}`,parent:d,url:$(`${d} .content${n} .addContent__feed__input`).val(),type:"rss",new:!0}]):r("Bad RSS feed URL"),l()})):"Weather forecast"===$(`${d} .newContent .addContent__select`).val()?($(`${d} .newContent .addContent`).removeClass("menu"),$(`${d} .newContent .addContent__select`).addClass("select"),$(`${d} .newContent .addContent__feed:visible`).length&&$(`${d} .newContent .addContent__feed`).hide(),$(`${d} .newContent .addContent__weather`).css({justifyContent:"center",alignItems:"center"}).addClass("flex"),$(`${d} .newContent .addContent__submitBtn`).click(()=>{s(),$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${$(`${d} .content${n} .addContent__weather__input`).val()}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{a(p)},200:e=>{l(),$(`${d} .content${n} .addContent`).hide(),t.emit("add content",[{element:`.content${n}`,parent:d,location:$(`${d} .content${n} .addContent__weather__input`).val(),type:"weather",new:!0}])}}})})):($(`${d} .newContent .addContent`).addClass("menu"),$(`${d} .newContent .addContent__select`).removeClass("select"),$(`${d} .newContent .addContent__feed, ${d} .newContent .addContent__weather, ${d} .newContent .addContent__btnContainer`).hide())}),$(`${d} .newContent .addContent__cancelBtn`).click(()=>{$(`${d} .newContent .addContent`).hide()})})})}).mouseleave(()=>{$(n).css({visibility:"hidden"})})}},500)}),$(p).ready(()=>{n!==e.length-1||$(`${p} .blank`).siblings("*:visible")||$(`${p} .blank`).hide()})}})},r=e=>{$(".msgContainer").addClass("warning").text(e).show(),setTimeout(()=>{$(".msgContainer").hide().removeClass("warning")},5e3)},c=n=>{let s=n.split(" ");if(n.startsWith("!")){if((e=>{let t=e.split(" ");for(let e=0;e<_.length;e++)if(t[0]===_[e].label){t.shift();let n=t.join(" ");void 0!==_[e].url&&null!==_[e]&&("!iv"===_[e].label?window.open(`${_[e].url}${n}&local=true`):"!pb"===_[e].label?window.open(`${_[e].url}${n}/-/`):window.open(`${_[e].url}${n}`))}$("#questionBox").val(""),$("#formContainer").css({borderRadius:"30px"}),$(".suggestion").hide()})(n),n.startsWith("!d ")){if(n.match(/[0-9A-Za-z_-]{11}/)){let s=n.match(/[0-9A-Za-z_-]{11}/)[0];t.emit("download",s),t.emit("audio info request",{id:s}),t.on("audio info retrieved",e=>{if(void 0!==e.title&&null!==e.title){let t=`Your download for ${e.title} started !`;$("#msgContainer").text(t),$("#msgContainer").show()}}),t.on("download ended",t=>{$("#msgContainer").text(`Your download for ${t.title} ended !`),setTimeout(()=>{$("#msgContainer").fadeOut(1500)},2e3),window.open(`http://${e}:8080/download`)})}else r("You pasted an invalid link. If you tried to paste a URL, try the video ID only.")}else if(n.startsWith("!p "))if(n.match(/[0-9A-Za-z_-]{11}/)&&!n.match(/[0-9A-Za-z_-]{15,34}/)){let e=n.match(/[0-9A-Za-z_-]{11}/)[0],s=`https://www.invidio.us/latest_version?id=${e}&itag=251&local=true`;if($(".audio__player").length)$("#audioSrc").attr("src",s);else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element.").appendTo(".player"),$("<source>").attr({id:"audioSrc",src:s,type:"audio/mpeg"}).appendTo(".audio__player")}t.emit("audio info request",{id:e}),document.getElementById("audio__player").load(),$(".moreContent").height("60%"),t.on("audio info retrieved",t=>{if(t.title=t.title.match(/[a-zA-Z0-9 \-#/\\_=+:;.]/g).join(""),!$(".streamInfoContainer").length){$("<span></span>").addClass("streamInfoContainer").append('<span id="streamText">You\'re listening to </span><span id="streamTitle"></span><p id="YtId"></p>').appendTo(".audioMsg")}($(".player__leftSvg").length||$(".player__rightSvg").length)&&$(".player__leftSvg, .player__rightSvg, .playlistInfo").hide(),$("#streamTitle").text(t.title),$("#YtId").text(` (Youtube ID : ${e})`).css({display:"block",margin:"0.5em 0 0.1em 0"}),$(".streamInfoContainer").css({textAlign:"center",width:"100%"}),$(".audioMsg, .streamInfoContainer, .audio__player").show(),$(".audio").fadeIn(1500)}),$(".audio").addClass("flex"),document.getElementById("audio__player").onended=()=>{$(".audio").fadeOut(1500)},p()}else if(null!==n.match(/[a-zA-Z0-9-_]{15,34}/)[0]){iPlaylist=0;let e=`https://invidio.us/api/v1/playlists/${n.match(/[a-zA-Z0-9-_]{15,34}/)[0]}`;t.emit("parse playlist",e),t.on("playlist parsed",()=>{$.ajax({url:"./tmp/playlist.json",dataType:"json",method:"GET"}).done(e=>{d(e)})})}else r("Bad URL :((")}else if(null!=n&&""!==n){let e=s.join("+");window.open(`https://duckduckgo.com/?q=${e}`),$("#questionBox").val("")}},p=()=>{$(".audio__remove").click(()=>{$(".audio").hide()})},g=()=>{""!==$("#questionBox").val()&&$("#form").submit(e=>{iPlaylist=0;let t=$("#questionBox").val();e.preventDefault(),c(t)})},_=[{label:"!1337x",desc:"1337x.to",icon:"./src/css/icons/suggestions/1337x.ico",url:"https://1337x.to/search/"},{label:"!afr",desc:"Amazon (FR)",icon:"./src/css/icons/suggestions/amazon.png",url:"https://www.amazon.fr/s?k="},{label:"!a",desc:"Amazon (US)",icon:"./src/css/icons/suggestions/amazon.png",url:"https://www.amazon.com/s?k="},{label:"!alto",desc:"AlternativeTo",icon:"./src/css/icons/suggestions/alto.ico",url:"https://alternativeto.net/browse/search?q="},{label:"!css",desc:"CSS Tricks",icon:"./src/css/icons/suggestions/csstricks.png",url:"https://css-tricks.com/?s="},{label:"!d",desc:"Download a YouTube audio stream",icon:"./src/css/icons/suggestions/"},{label:"!fdroid",desc:"F-Droid",icon:"./src/css/icons/suggestions/fdroid.png",url:"https://search.f-droid.org/?q="},{label:"!g",desc:"Google",icon:"./src/css/icons/suggestions/google.png",url:"https://www.google.com/search?q="},{label:"!gh",desc:"Github",icon:"./src/css/icons/suggestions/github.ico",url:"https://github.com/search?q="},{label:"!gt",desc:"Google translate",icon:"./src/css/icons/suggestions/gt.ico",url:"https://translate.google.com/#view=home&op=translate&sl=auto&tl=en&text="},{label:"!gmap",desc:"Google Maps",icon:"./src/css/icons/suggestions/maps.ico",url:"https://www.google.be/maps/search/"},{label:"!iv",desc:"Invidio.us",icon:"./src/css/icons/suggestions/invidious.png",url:"https://invidio.us/search?q="},{label:"!jquery",desc:"Jquery API",icon:"./src/css/icons/suggestions/jquery.ico",url:"https://api.jquery.com/?ns0=1&s="},{label:"!jq",desc:"Jquery API",icon:"./src/css/icons/suggestions/jquery.ico",url:"https://api.jquery.com/?ns0=1&s="},{label:"!ldlc",desc:"LDLC",icon:"./src/css/icons/suggestions/ldlc.png",url:"https://www.ldlc.com/fr-be/recherche/"},{label:"!li",desc:"LinkedIn",icon:"./src/css/icons/suggestions/linkedin.ico",url:"https://www.linkedin.com/search/results/all/?keywords="},{label:"!mdn",desc:"Mozilla Developer network",icon:"./src/css/icons/suggestions/mdn.png",url:"https://developer.mozilla.org/en-US/search?q="},{label:"!pb",desc:"Pages Blanches (BE)",icon:"./src/css/icons/suggestions/pagesblanches.ico",url:"https://www.pagesblanches.be/chercher/personne/"},{label:"!os",desc:"OpenSubtitles",icon:"./src/css/icons/suggestions/opensub.ico",url:"https://www.opensubtitles.org/en/search2/sublanguageid-all/moviename-"},{label:"!osm",desc:"OpenStreetMap",icon:"./src/css/icons/suggestions/osm.png",url:"https://www.openstreetmap.org/search?query="},{label:"!owm",desc:"OpenWeatherMap",icon:"./src/css/icons/suggestions/owm.ico",url:"https://openweathermap.org/find?q="},{label:"!p",desc:"Play a Youtube audio stream or playlist",icon:"./src/css/icons/suggestions/play.svg"},{label:"!rarbg",desc:"RARBG",icon:"./src/css/icons/suggestions/rarbg.png",url:"http://rarbgmirror.org/torrents.php?search="},{label:"!rt",desc:"Rottentomatoes",icon:"./src/css/icons/suggestions/rottentomatoes.png",url:"https://www.rottentomatoes.com/search/?search="},{label:"!rtbf",desc:"RTBF",icon:"./src/css/icons/suggestions/rtbf.png",url:"https://www.rtbf.be/info/recherche?q="},{label:"!sc",desc:"SoundCloud",icon:"./src/css/icons/suggestions/soundcloud.ico",url:"https://soundcloud.com/search?q="},{label:"!so",desc:"Stack Overflow",icon:"./src/css/icons/suggestions/so.ico",url:"https://stackoverflow.com/search?q="},{label:"!torrent",desc:"Torrent9.cz",icon:"./src/css/icons/suggestions/torrent9.ico",url:"https://www.torrent9.cz/recherche/"},{label:"!translate",desc:"Google translate",icon:"./src/css/icons/suggestions/gt.ico",url:"https://translate.google.com/#view=home&op=translate&sl=auto&tl=en&text="},{label:"!uc",desc:"Unicode table",icon:"./src/css/icons/suggestions/unicode.ico",url:"https://unicode-table.com/en/search/?q="},{label:"!w",desc:"Wikipedia (EN)",icon:"./src/css/icons/suggestions/wikipedia.ico",url:"https://en.wikipedia.org/w/index.php?search="},{label:"!wfr",desc:"Wikipedia (FR)",icon:"./src/css/icons/suggestions/wikipedia.ico",url:"https://fr.wikipedia.org/w/index.php?search="},{label:"!wt",desc:"Wikitionnary (EN)",icon:"./src/css/icons/suggestions/wt.ico",url:"https://en.wiktionary.org/w/index.php?search="},{label:"!wtfr",desc:"Wikitionnary (FR)",icon:"./src/css/icons/suggestions/wt.ico",url:"https://fr.wiktionary.org/w/index.php?search="},{label:"!yarn",desc:"Yarn",icon:"./src/css/icons/suggestions/yarn.ico",url:"https://yarnpkg.com/en/packages?q="},{label:"!yt",desc:"Youtube",icon:"./src/css/icons/suggestions/yt.ico",url:"https://www.youtube.com/results?search_query="}],u=e=>{if(e.description.match(/clear sky/i))$(".forecast__weatherIcon__icon").text("☼").css({color:"yellow"});else if(e.description.match(/clouds/i))$(".forecast__weatherIcon__icon").text("☁");else if(e.description.match(/rain/i))$(".forecast__weatherIcon__icon").text("🌧");else if(e.description.match(/mist/i)){$(".forecast__weatherIcon__icon").addClass("icon flex");let e=$("<img>").attr({src:"./src/css/icons/interface/mist.svg",alt:"Mist icon"});$(".forecast__weatherIcon__icon img").length?$(".forecast__weatherIcon__icon img").replaceWith(e):e.appendTo($(".forecast__weatherIcon__icon"))}};$(".content3__container .content3").ready(()=>{$(".credits").hide(),n(".content1__container",".content1"),n(".content2__container",".content2"),n(".content3__container",".content3"),(()=>{let e={},n=$(".toggleRss__Input").prop("checked");n?$(".toggleRss__Slider").removeClass("unchecked"):$(".toggleRss__Slider").addClass("unchecked"),$("#settingsBtn").click(()=>{$("#backgroundImage, header, #mainContainer").css("filter","blur(4px)"),$(".settings__container").fadeIn().css("display","flex").addClass("flex")}),$("#backgroundImageUploadForm__Btn").click(()=>{$("#backgroundImageUploadForm__InputFile").click()}),$("#toggleRss__Switch").click(()=>{e.RSS=$(".toggleRss__Input").prop("checked"),$(".toggleRss__Input").prop("checked")?$(".toggleRss__Slider").removeClass("unchecked"):$(".toggleRss__Slider").addClass("unchecked")}),$("#settings__child__cancelBtn").click(()=>{$("#backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container").fadeOut()}),$("#settings__child__saveBtn").click(()=>{if(""!==$("#backgroundImageUploadForm__InputFile").val()&&""===$("#backgroundImageUploadForm__InputUrl").val()){let t=$("#backgroundImageUploadForm__InputFile").val().split("\\");t.splice(0,2);let n=t[0];e.backgroundImage=`./upload/${n}`;let s=new FormData;s.append("backgroundImageUploadInput",$("#backgroundImageUploadForm__InputFile")[0].files[0],n),$.ajax({url:"/upload",type:"POST",data:s,processData:!1,contentType:!1,statusCode:{200:()=>{console.log(s,"file sent !")},404:()=>{console.log("page not found !")}}}),$("#backgroundImage").css("backgroundImage",e.backgroundImageFile)}else""===$("#backgroundImageUploadForm__InputFile").val()&&""!==$("#backgroundImageUploadForm__InputUrl").val()?$("#backgroundImageUploadForm__InputUrl").val().match(/^(http|https):\/\/(www.|)[a-zA-Z0-9\/]{1,}\.\w.+/i)&&($("#backgroundImageUploadForm__InputUrl").val().length<100?(e.backgroundImage=$("#backgroundImageUploadForm__InputUrl").val(),$("#backgroundImage").css("backgroundImage",e.backgroundImage)):o("Your URL is too large ! Please shorten it !")):""!==$("#backgroundImageUploadForm__InputFile").val()&&""!==$("#backgroundImageUploadForm__InputUrl").val()&&o("Hey, don't be too powerful dude ! One field at a time !");$(".toggleRss__Input").prop("checked"),""===$("#backgroundImageUploadForm__InputFile").val()&&""===$("#backgroundImageUploadForm__InputUrl").val()&&""===$(".owmToken__input").val()&&($("#backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container").fadeOut()),$(".owmToken__input").val().match(/[a-z0-9]{32}/)&&(e.owmToken=$(".owmToken__input").val()),t.emit("customization",e),$(".owmToken__Comment").text(`Your OpenWeatherMap token is ${e.owmToken}. You can update it here !`),$("#backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container").fadeOut(),e.RSS!==n&&location.reload()}),t.on("RSS status retrieved",e=>{e?$(".toggleRss__Input").prop("checked",!0):$(".toggleRss__Input").prop("checked",!1)})})(),l(),$("#toggleRss__Input").prop("checked")||$(".moreContent").hide(),t.on("refresh app",()=>{location.reload()}),t.on("errorMsg",e=>{r(e)}),t.on("server settings updated",e=>{null!=e&&($("#backgroundImage").css("background-image",`url(${e.backgroundImage})`),$("#backgroundImage, header, #mainContainer").css("filter","none"),$("#settings").fadeOut())}),$("#questionBox").on("input",()=>{(e=>{let t=_.filter(t=>{const n=new RegExp(`^${e}`,"gi");return t.label.match(n)});if(e.length||(t=[],$(".suggestions").text(""),$(".formContainer").css({borderRadius:"30px",padding:"0.5% 1%"}),$(".suggestions").removeClass("active")),t!==[]&&e.length>=2&&e.startsWith("!"))if($(".formContainer").css({borderRadius:"30px 30px 0 0",paddingBottom:0}),$(".suggestions").hasClass("active")||$(".suggestions").addClass("active"),$(".suggestions").css({width:$(".formContainer").innerWidth()}),t!==[]&&t.length>0){const e=t.map(e=>`\n            <div class="suggestion flex">\n              <img class="suggestion__icon" src="${e.icon}" alt="${e.desc} icon" height="20px" />\n              <span class="suggestion__label">${e.label}</span>\n              <span class="suggestion__desc">${e.desc}</span>\n            </div>\n            `).join("");$(".suggestions").html(e),$(".suggestion").click(e=>{let t,n=e.target;"suggestion__label"===n.className?t=n.textContent:"suggestion__icon"===n.className?t=n.nextElementSibling.textContent:"suggestion__desc"===n.className?t=n.previousElementSibling.textContent:"suggestion"===n.className&&(t=n.children[1].textContent),t&&$("#questionBox").val(`${t} `).focus()})}else $(".suggestions").removeClass("active")})($("#questionBox").val())}),$("#form").keypress(e=>{13===e.keyCode&&(g(),$("#formContainer").css({padding:"0.5% 1%"}))}),$("#formSubmit").click(()=>{g()}),$("#msgContainer").text().match(/\w.+/)?i("#msgContainer"):$("#msgContainer").hide(),$(window).mousemove(e=>{mousePosition.x=e.pageX,mousePosition.y=e.pageY}),$("#footer").mouseenter(()=>{$("#credits").fadeIn()}).mouseleave(()=>{$("#credits").fadeOut()})})});

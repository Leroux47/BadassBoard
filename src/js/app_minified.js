let contentHeight,iPlaylist=0,mousePosition={},owmToken="";$.ajax({url:"./settings/ip.txt",method:"GET"}).done(e=>{const t=io.connect(`http://${e}:8080`);$.ajax({url:"./settings/settings.json",method:"GET",dataType:"json"}).done(e=>{void 0!==e.backgroundImage&&$.ajax({url:e.backgroundImage,method:"GET",dataType:"",statusCode:{200:()=>{$("head").append(`<style>.formContainer__container::before {background-image: url(${e.backgroundImage});}</style>`),$(".backgroundImage").css("backgroundImage",`url(${e.backgroundImage})`)},404:()=>{$("#msgContainer").text("Sorry, your background image couldn't be loaded... Maybe try another one").fade("#msgContainer")}}}),void 0!==e.owmToken&&(owmToken=e.owmToken,$(".owmToken__Comment").text(`Your OpenWeatherMap token is ${owmToken}. You can update it here !`))});const n=(e,n)=>{let s=`${e} ${n} .blank`;contentHeight=$(".content").height(),setTimeout(()=>{$(`${n} .rssContainer`).length||$(`${n} .forecast`).length||$(n).mouseenter(()=>{$(s).addClass("flex visible").removeClass("invisible")}).mouseleave(()=>{$(s).addClass("invisible").removeClass("visible")})},1e3),$(s).click(()=>{$(n).css("padding","0"),$(`${e} ${n} .addContent`).addClass("flex"),$(s).hide(),$(n).mouseenter(()=>{$(`${e} ${n} .addContent`).is(":visible")&&$(s).hide()}),$(`${e} ${n} .addContent`).ready(()=>{$(`${e} ${n} .addContent__select`).on("change",()=>{if($(`${e} ${n} .addContent__btnContainer`).css("display","inline-flex"),"Add a feed"===$(`${e} ${n} .addContent__select`).val()){$(`${e} ${n} .addContent`).removeClass("menu"),$(`${e} ${n} .addContent__select`).addClass("select"),$(`${e} ${n} .addContent__feed`).css("display","").addClass("flex"),$(`${e} ${n} .addContent__weather:visible`).length&&$(`${e} ${n} .addContent__weather`).hide();const s=()=>{$(`${e} ${n} .addContent__submitBtn`).click(()=>{null!==$(`${e} ${n} .addContent__feed__input`).val()&&void 0!==$(`${e} ${n} .addContent__feed__input`).val()&&$(`${e} ${n} .addContent__feed__input`).val().match(/^http/i)?(t.emit("add content",[{element:n,parent:e,url:$(`${e} ${n} .addContent__feed__input`).val(),type:"rss",new:!1}]),c(),$(`${e} ${n} .addContent`).hide()):(p({type:"rss",msg:"Hey, this value is invalid !",element:`${e} ${n} .addContent__feed`}),s())})};s()}else if("Weather forecast"===$(`${e} ${n} .addContent__select`).val()){$(`${e} ${n} .addContent`).removeClass("menu"),$(`${e} ${n} .addContent__select`).addClass("select"),$(`${e} ${n} .addContent__feed:visible`).length&&$(`${e} ${n} .addContent__feed`).hide(),$(`${e} ${n} .addContent__weather`).css({justifyContent:"center",alignItems:"center",display:""}).addClass("flex");const s=()=>{$(`${e} ${n} .addContent__submitBtn`).click(()=>{$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${$(`${e} ${n} .addContent__weather__input`).val()}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{p({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:`${e} ${n}`}),s()},200:s=>{1===s.count?(c(),t.emit("add content",[{element:n,parent:e,location:$(`${e} ${n} .addContent__weather__input`).val(),type:"weather",new:!1}])):p({type:"weather",msg:"Sorry homie, it seems this location doesn't exist...",element:`${e} ${n}`})}}})})};s()}else $(`${e} ${n} .addContent`).addClass("menu"),$(`${e} ${n} .addContent__select`).removeClass("select"),$(`${e} ${n} .addContent__feed, ${e} ${n} .addContent__weather, ${e} ${n} .addContent__btnContainer`).hide()}),$(`${e} ${n} .addContent__cancelBtn`).click(()=>{$(`${e} ${n} .addContent`).hide(),$(s).show()})})})},s=e=>{contentHeight=$(".content").height();const a=(e,t,s)=>{$(t).length&&($(s).mouseenter(()=>{$(`${e} .contentOptions`).css("display","flex")}).mouseleave(()=>{$(`${e} .contentOptions`).hide()}),$(`${e} .removeContentBtn`).click(()=>{$(t).remove(),$(t).length||($(e).css({height:contentHeight}),$(`${e} .blank`).css({height:contentHeight}).addClass("flex")),n(`.${$(e).parent().attr("class").match(/content\d__container/)}`,`.${$(e).attr("class").match(/content\d{1,}/)}`)}))},d=(e,n,a)=>{$(n).length&&($(a).mouseenter(()=>{$(`${n} .contentOptions`).addClass("flex")}).mouseleave(()=>{$(`${n} .contentOptions`).hide()}),$(`${n} .updateContentBtn`).click((function(){if(n.match(/rss/i))t.emit("update feed",{element:`.${$(this).parents(".rssContainer").parent().attr("id")}`,parent:`.${$(this).parents(".content__container").attr("id")}`}),t.on("feed updated",e=>{let t=`${e.parent} ${e.element}`,n=e.feed;o(n,(e,n)=>{$(`${t} .rssContainer`).replaceWith(n);let o=$("<div></div>").addClass("rssContainer__header").prependTo(n),a=($("<a></a>").addClass("feedTitle").attr({href:e[0].meta.link}).text(e[0].meta.title).prependTo(o),$("<span></span>").addClass("contentOptions").appendTo(o));$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./src/css/icons/interface/refresh.svg"}).appendTo(a),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./src/css/icons/interface/cross.svg"}).appendTo(a);s(t),i(),$(`${t} .rssContainer__header`).mouseenter(()=>{$(`${t} .contentOptions`).addClass("flex")}).mouseleave(()=>{$(`${t} .contentOptions`).addClass("flex")})})});else if(n.match(/forecast/i)){let t=$(".forecast__header__title").text().split(" ");t.splice(0,2),t=t[0],$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${t}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{p({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:e})},200:e=>{let t=e.list[0].weather[0].description.split(""),n=t[0].toUpperCase();t.shift(),t.unshift(n),t=t.join("");let s={temp:e.list[0].main.temp,city:e.list[0].name,description:t,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};$(".forecast__content__info__description__desc").text(s.description),$(".forecast__content__info__temp__desc").text(`${s.temp} °C`),$(".forecast__content__info__wind__desc").text(`${s.windSpeed} km/h`),$(".forecast__content__info__humidity__desc").text(`${s.humidity} %`),m(s)}}})}})))};$(`${e} .rssContainer`).ready(()=>{a(e,`${e} .rssContainer`,`${e} .rssContainer__header`),d(e,`${e} .rssContainer`,`${e} .rssContainer__header`)}),$(`${e} .forecast`).ready(()=>{a(e,`${e} .forecast`,`${e} .forecast__header`),d(e,`${e} .forecast`,`${e} .forecast__header`)})},o=(e,t)=>{let n=$("<section></section>"),s=$("<div></div>");for(let t=0;t<10;t++)if(void 0!==e[t]&&void 0!==e[t].title&&void 0!==e[t].link){n.addClass("rssContainer flex"),s.addClass("linksContainer").appendTo(n);let o=$("<div></div>").addClass("article flex").appendTo(s);$("<a></a>").addClass("link").attr("href",e[t].link).text(e[t].title).appendTo(o),$("<div></div>").addClass("article__desc").append(e[t].summary).appendTo(s)}t(e,n)},a=e=>{e?($(".toggleRss__Input").prop("checked",!0),$("#toggleRss__Slider").removeClass("unchecked"),n(".content1__container",".content1"),n(".content2__container",".content2"),n(".content3__container",".content3"),"none"===$(".moreContent").css("display")&&($(".moreContent").css("display",""),$(".formContainer__container").css({position:"",top:""}))):($(".toggleRss__Input").prop("checked",!1),$("#toggleRss__Input").prop("checked")||($(".moreContent").hide(),$(".formContainer__container").css({position:"absolute",top:"30%"})))},i=()=>{$(".article").mouseenter(e=>{!$(".rssTooltip .article__desc").length&&e.currentTarget.className.match("article")&&($(e.currentTarget.nextElementSibling).clone().appendTo(".rssTooltip"),mousePosition.x<$(window).width()/100*30?$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x+$(window).width()/100*15}):$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x-$(window).width()/100*35}))}).mouseleave(e=>{$(".rssTooltip .article__desc").remove()})},d=e=>{$(e).fadeIn(2e3,()=>{setTimeout(()=>{$(e).fadeOut(2e3)},5e3)})},l=e=>{$(e).click(()=>{".audio__remove"===e?(document.getElementById("audio__player").pause(),$(".audio").hide()):".converter__remove"===e&&$(".upperContainer__converter").fadeOut()}),$(".moreContent").css("marginTop","")},r=e=>{if($(".audio").addClass("flex"),$(".player__leftSvg, .player__rightSvg").off(),l(".audio__remove"),void 0===e.videos[iPlaylist])p({type:"generic",msg:"Invalid playlist reference !"});else if(iPlaylist<e.videoCount&&!e.videos[iPlaylist].title.match(/deleted video/gi)&&void 0!==e.videos[iPlaylist]){if($(".moreContent").css("marginTop",0),$(".audio__player").length){if($("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),!$(".player__leftSvg").length){$('<svg class="player__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').hide().prependTo(".player"),$('<svg class="player__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').hide().appendTo(".player")}$(".streamInfoContainer, .player, .playlistInfo, .player__leftSvg, .player__rightSvg").show(),$(".playlistEndMsg").hide()}else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element :(").appendTo(".player"),$('<svg class="player__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').prependTo(".audio"),$('<svg class="player__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').appendTo(".audio"),$("<source>").attr({id:"audioSrc",src:`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`,type:" audio/mpeg"}).appendTo(".audio__player")}if($(".streamInfoContainer").length)if($("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(`(Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").length)$(".playlistInfo").show().text(`${iPlaylist+1}/${e.videoCount}`);else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`).show().prependTo(".audioMsg")}else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`).show().prependTo(".audioMsg"),$("<span></span>").addClass("streamInfoContainer").appendTo(".audioMsg"),$("<span></span>").attr("id","streamTitle").text(e.videos[iPlaylist].title).appendTo(".streamInfoContainer"),$("<span></span>").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`).attr("id","YtId").appendTo(".streamInfoContainer")}document.getElementById("audio__player").load(),document.getElementById("audio__player").onended=()=>{if(iPlaylist++,void 0!==e.videos[iPlaylist])r(e);else{if($(".player__rightSvg").hide(),$(".player, .streamInfoContainer, .playlistInfo").hide(),!$(".endOfPlaylist").length){$("<span></span>").text("There is no track left in here... 😭").addClass("playlistEndMsg").prependTo(".audioMsg")}$(".audioMsg").css("justify-content","center"),d($(".audio"))}},$(".audio__player").show(),$(".audioMsg").show(),$(".audio").fadeIn(1500,()=>{$(".audio").css("display","flex")}),(e=>{void 0!==e.videos[iPlaylist]&&(iPlaylist<e.videoCount?(0===iPlaylist&&$(".player__leftSvg").hide(),$(".player__rightSvg").click(()=>{++iPlaylist<e.videoCount&&void 0!==e.videos[iPlaylist]&&($("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`),iPlaylist>0&&$(".player__leftSvg").show(),iPlaylist===e.videoCount-1&&$(".player__rightSvg").hide())}),$(".player__leftSvg").click(()=>{iPlaylist>0&&(iPlaylist--,$("#audioSrc").attr("src",`https://www.invidio.us/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videoCount}`)),0===iPlaylist?$(".player__leftSvg").hide():iPlaylist>0&&$(".player__rightSvg").show()})):$(".player__rightSvg").show())})(e)}else void 0===e.videos[iPlaylist]?p({type:"generic",msg:"Video ID not found !"}):e.videos[iPlaylist].title.match(/(deleted video) || (private video)/gi)&&(iPlaylist++,r(e))},c=()=>{t.on("parse content",e=>{console.log("parsing requested");for(const[n,a]of e.entries()){const d=(e,t,n,s)=>{if($(t).length)s();else{let o=$("<div></div>").addClass(`content content${n}`).attr("id",`content${n}`);$(t).length||o.appendTo(e),$(t).ready(()=>{$(`${t} .blank`).length||$(`${t} .addContent`).length||$(t).prepend(_).append(h),s()})}};let l=a.parent,r=a.element,g=`${a.parent} ${a.element}`,u=Number(r.match(/[0-9]{1,}/)),_=$(".blank").clone()[0],h=$(".addContent").clone()[0];d(l,g,u,()=>{const e=()=>{let e=$(`${l} .newContent .blank`);e.addClass("flex"),$(`${l} .newContent`).mouseenter(()=>{$(e).css({visibility:"visible",display:""}).addClass("flex"),$(e).click(()=>{$(g).css("padding","0"),$(e).off().hide(),$(`${l} .newContent .addContent`).css("display","").addClass("flex"),$(`${l} .newContent`).mouseenter(()=>{$(`${l} .newContent .addContent`).is(":visible")&&$(e).css({display:"none"})}),$(`${l} .newContent .addContent`).ready(()=>{let e;const n=()=>{void 0!==$(`${l} .newContent`).prev().attr("class")&&(e=Number($(`${l} .newContent`).prev().attr("id").substring(7,9))+1,console.log($(`${l} .newContent`).prev().attr("id").substring(7,9),e)),$(`${l} .newContent`).removeClass("newContent subRow flex").attr("id",`content${e}`).addClass(`content${e}`)};$(`${l} .newContent .addContent__select`).on("change",()=>{if($(`${l} .newContent .addContent__btnContainer`).css("display","inline-flex"),"Add a feed"===$(`${l} .newContent .addContent__select`).val()){$(`${l} .newContent .addContent`).removeClass("menu"),$(`${l} .newContent .addContent__select`).addClass("select"),$(`${l} .newContent .addContent__weather:visible`).length&&$(`${l} .newContent .addContent__weather`).hide(),$(`${l} .newContent .addContent__feed`).addClass("flex");const s=o=>{$(`${o} .addContent__submitBtn`).click(()=>{n(),null!==$(`${l} .content${e} .addContent__feed__input`).val()&&void 0!==$(`${l} .content${e} .addContent__feed__input`).val()&&$(`${l} .content${e} .addContent__feed__input`).val().match(/^http/i)?(console.log("add content"),t.emit("add content",[{element:`.content${e}`,parent:l,url:$(`${l} .content${e} .addContent__feed__input`).val(),type:"rss",new:!0}]),$(`${l} .content${e} .addContent`).hide(),c()):(p({type:"rss",msg:"Hey, this value is invalid !",element:`${l} .content${e} .addContent__feed`}),s(`${l} .content${e}`))})};s(`${l} .newContent`)}else if("Weather forecast"===$(`${l} .newContent .addContent__select`).val()){$(`${l} .newContent .addContent`).removeClass("menu"),$(`${l} .newContent .addContent__select`).addClass("select"),$(`${l} .newContent .addContent__feed:visible`).length&&$(`${l} .newContent .addContent__feed`).hide(),$(`${l} .newContent .addContent__weather`).css({justifyContent:"center",alignItems:"center"}).addClass("flex");const s=o=>{$(o).click((function(){n();let o=`.${$(this).parents(".content__container").attr("id")}`,a=`.${$(this).parents(".content").attr("id")}`;$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${$(`${o} .content${e} .addContent__weather__input`).val()}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{400:()=>{p({type:"weather",msg:"Something is wrong with your request... Please contact the dev to fix it.",element:`${o} ${a}`})},401:()=>{p({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:`${o} ${a}`}),s(`${o} .content${e} .addContent__submitBtn`)},200:e=>{c(),$(`${o} ${a} .addContent`).hide(),t.emit("add content",[{element:a,parent:o,location:$(`${o} ${a} .addContent__weather__input`).val(),type:"weather",new:!0}])}}})}))};s(`${l} .newContent .addContent__submitBtn`)}else $(`${l} .newContent .addContent`).addClass("menu"),$(`${l} .newContent .addContent__select`).removeClass("select"),$(`${l} .newContent .addContent__feed, ${l} .newContent .addContent__weather, ${l} .newContent .addContent__btnContainer`).hide()}),$(`${l} .newContent .addContent__cancelBtn`).click((function(){$(this).parent(".addContent").hide(),$(this).parent(".blank").css({visibility:"visible",display:"flex"})}))})})}).mouseleave(()=>{$(e).css({visibility:"hidden"})})},n=()=>{setTimeout(()=>{if(!$(`${l} .newContent`).length){$("<div></div>").addClass("newContent content subRow flex").appendTo(l).prepend(_).append(h)}"absolute"===$("footer").css("position")&&$(".footer").css({position:"",top:""}),e(),$(".newContent").ready(()=>{$(".content").each((function(e){$(this).hasClass("newContent")?$(this).css("order",100):$(this).css("order",$(this).attr("id").substring(7,9))}))})},500)};if($(g).off(),"weather"===a.type&&($(`${g} .forecast`).length||void 0!==a.location&&owmToken.match(/[a-z0-9]{32}/)&&$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${a.location}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{p({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:g})},200:e=>{e.cod;if(1===e.count){$(`${g} .addContent:visible`).length&&$(`${g} .addContent`).hide();let t=e.list[0].id,o=e.list[0].weather[0].description.split(""),a=o[0].toUpperCase();o.shift(),o.unshift(a),o=o.join("");let i={temp:e.list[0].main.temp,city:e.list[0].name,description:o,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};if(!$(`${g} .forecast`).length){let e=$("<section></section>").addClass("forecast flex").appendTo(g),o=$("<span></span>").addClass("forecast__header").appendTo(e),a=($("<a></a>").addClass("forecast__header__title").text(`Weather in ${i.city}`).attr("href",`https://openweathermap.org/city/${t}`).appendTo(o),$("<div></div>").addClass("forecast__content flex").appendTo(e)),d=$("<div></div>").addClass("forecast__content__info flex").appendTo(a),l=$("<span></span>").addClass("forecast__content__info__desc").appendTo(d),r=($("<p></p>").addClass("forecast__content__info__description__desc flex").text(i.description).appendTo(l),$("<span></span>").addClass("forecastIcon").text("🛈").prependTo(l),$("<span></span>").addClass("forecast__content__info__temp").appendTo(d)),c=($("<p></p>").addClass("forecast__content__info__temp__desc flex").text(`${i.temp} °C`).appendTo(r),$("<span></span>").addClass("forecastIcon").text("🌡").prependTo(r),$("<span></span>").addClass("forecast__content__info__wind").appendTo(d)),p=($("<p></p>").addClass("forecast__content__info__wind__desc").text(`${i.windSpeed} km/h`).appendTo(c),$("<img>").addClass("forecastIcon").attr({alt:"wind icon",src:"./src/css/icons/interface/wind.svg"}).prependTo(c),$("<span></span>").addClass("forecast__content__info__humidity").appendTo(d)),u=($("<p></p>").addClass("forecast__content__info__humidity__desc flex").text(`${i.humidity} %`).appendTo(p),$("<span></span>").addClass("forecastIcon").text("💧").prependTo(p),$("<div></div>").addClass("forecast__weatherIcon flex").appendTo(a));$("<span></span>").addClass("forecast__weatherIcon__icon").appendTo(u);m(i);let _=$("<span></span>").addClass("contentOptions").appendTo(o);$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./src/css/icons/interface/refresh.svg"}).appendTo(_),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./src/css/icons/interface/cross.svg"}).appendTo(_);s(g),n()}}else p({type:"weather",msg:"Sorry homie, it seems this location doesn't exist...",element:g})}}})),"rss"===a.type){let e=a.feed;$(`${g} .rssContainer`).length||o(e,(e,t)=>{t.appendTo(g);let o=$("<div></div>").addClass("rssContainer__header").prependTo(`${g} .rssContainer`),a=($("<a></a>").addClass("feedTitle").attr({href:e[0].meta.link}).text(e[0].meta.title).prependTo(`${g} .rssContainer__header`),$("<span></span>").addClass("contentOptions").appendTo(o));$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./src/css/icons/interface/refresh.svg"}).appendTo(a),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./src/css/icons/interface/cross.svg"}).appendTo(a);i(),s(g),n()})}l.match(u)||$(g).addClass("subRow")}),$(g).ready(()=>{n!==e.length-1||$(`${g} .blank`).siblings("*:visible")||$(`${g} .blank`).hide()})}})},p=e=>{if("generic"===e.type)$(".msgContainer").addClass("warning").text(e.msg).show(),setTimeout(()=>{$(".msgContainer").hide().removeClass("warning")},5e3);else if("weather"===e.type){if(null!==e.element&&void 0!==e.element&&($(e.element).off(),!$(`${e.element} .warning`).length)){$("<span></span>").addClass("warning").text(e.msg).appendTo(`${e.element} .addContent__weather`)}}else if("rss"===e.type){$("<span></span>").addClass("warning").text(e.msg).appendTo(e.element)}else if("rss verification"===e.type){if($(e.element).off(),!$(`${e.element} .rssWarning`).length){$(`${e.element} .addContent, ${e.element} .addContent__feed`).css("display","").addClass("flex");$("<span></span>").addClass("warning rssWarning").text(e.msg).appendTo($(`${e.element} .addContent__feed`))}}else if("unit conversion"===e.type)if($(".upperContainer__converter .warning").length)$(".upperContainer__converter .waring").css("display","flex");else{$("<b></b>").text(e.msg).addClass("warning").appendTo(e.element)}else if("upload"===e.type&&!$(".settings__container .uploadWarning").length){let t=$("<b></b>").text(e.msg).addClass("warning uploadWarning").css("display","");$("#backgroundImageUploadForm").after(t)}},g=n=>{let s=n.split(" ");if(n.startsWith("!")){if((e=>{let t=e.split(" ");for(let e=0;e<h.length;e++)if(t[0]===h[e].label){t.shift();let n=t.join(" ");void 0!==h[e].url&&null!==h[e]&&("!iv"===h[e].label?window.open(`${h[e].url}${n}&local=true`):"!pb"===h[e].label?window.open(`${h[e].url}${n}/-/`):window.open(`${h[e].url}${n}`))}$("#questionBox").val(""),$("#formContainer").css({borderRadius:"30px"}),$(".suggestion").hide()})(n),n.startsWith("!d ")){if(n.match(/[0-9A-Za-z_-]{11}/)){let s=n.match(/[0-9A-Za-z_-]{11}/)[0];t.emit("download",s),t.emit("audio info request",{id:s}),t.on("audio info retrieved",e=>{if(void 0!==e.title&&null!==e.title){let t=`Your download for ${e.title} started !`;$("#msgContainer").text(t),$("#msgContainer").show()}}),t.on("download ended",t=>{$("#msgContainer").text(`Your download for ${t.title} ended !`),setTimeout(()=>{$("#msgContainer").fadeOut(1500)},2e3),window.open(`http://${e}:8080/download`)})}else p({type:"generic",msg:"You pasted an invalid link. If you tried to paste a URL, try the video ID only"})}else if(n.startsWith("!p "))if(n.match(/[0-9A-Za-z_-]{11}/)&&!n.match(/[0-9A-Za-z_-]{15,34}/)){let e=n.match(/[0-9A-Za-z_-]{11}/)[0],s=`https://www.invidio.us/latest_version?id=${e}&itag=251&local=true`;if($(".audio__player").length)$("#audioSrc").attr("src",s);else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element.").appendTo(".player"),$("<source>").attr({id:"audioSrc",src:s,type:"audio/mpeg"}).appendTo(".audio__player")}t.emit("audio info request",{id:e}),document.getElementById("audio__player").load(),t.on("audio info retrieved",t=>{if(t.title=t.title.match(/[a-zA-Z0-9 \-#/\\_=+:;.]/g).join(""),!$(".streamInfoContainer").length){let e=$("<span></span>").addClass("streamInfoContainer").appendTo(".audioMsg");$("<span></span>").attr("id","streamTitle").appendTo(e),$("<span></span>").attr("id","YtId").appendTo(e)}($(".player__leftSvg").length||$(".player__rightSvg").length)&&$(".player__leftSvg, .player__rightSvg, .playlistInfo").hide(),$("#streamTitle").text(t.title),$("#YtId").text(`(Youtube ID : ${e})`),$(".streamInfoContainer").css({textAlign:"center",width:"100%"}),$(".audioMsg, .streamInfoContainer, .audio__player").show(),$(".audio").fadeIn(1500,()=>{$(".audio").css("display","flex")})}),document.getElementById("audio__player").onended=()=>{$(".audio").fadeOut(1500)},l(".audio__remove")}else if(null!==n.match(/[a-zA-Z0-9-_]{15,34}/)[0]){iPlaylist=0;let e=`https://invidio.us/api/v1/playlists/${n.match(/[a-zA-Z0-9-_]{15,34}/)[0]}`;t.emit("parse playlist",e),t.on("playlist parsed",()=>{$.ajax({url:"./tmp/playlist.json",dataType:"json",method:"GET"}).done(e=>{r(e)})})}else p({type:"generic",msg:"Bad URL :(("})}else if(null!=n&&""!==n){let e=s.join("+");window.open(`https://duckduckgo.com/?q=${e}`),$("#questionBox").val("")}},u=()=>{""!==$("#questionBox").val()&&$("#form").submit(e=>{iPlaylist=0;let t=$("#questionBox").val();e.preventDefault(),g(t)})},_=()=>{let e;$(".converterBtn").on("click",(function(){$(".upperContainer__converter").fadeIn().css("display","flex")})),$(".converter__input, .converter__value1, .converter__value2").on("change",()=>{let t=$(".converter__value1").val(),n=Number($(".converter__input").val()),s=$(".converter__value2").val();isNaN(n)?p({type:"unit conversion",element:$(".upperContainer__converter"),msg:"Please enter a numeric value... 😑"}):("Byte"===t?"Kilobyte"===s?e=n/Math.pow(1024,1):"Megabyte"===s?e=n/Math.pow(1024,2):"Gigabyte"===s?e=n/Math.pow(1024,3):"Terabyte"===s?e=n/Math.pow(1024,4):"Byte"===s&&(e=n):"Kilobyte"===t?"Byte"===s?e=n*Math.pow(10,6):"Megabyte"===s?e=n/Math.pow(10,3):"Gigabyte"===s?e=n/Math.pow(10,6):"Terabyte"===s?e=n/Math.pow(10,9):"Kilobyte"===s&&(e=n):"Megabyte"===t?"Kilobyte"===s?e=n*Math.pow(10,3):"Byte"===s?e=n*Math.pow(10,6):"Gigabyte"===s?e=n/Math.pow(10,3):"Terabyte"===s?e=n/Math.pow(10,6):"Megabyte"===s&&(e=n):"Gigabyte"===t?"Kilobyte"===s?e=n*Math.pow(10,6):"Byte"===s?e=n*Math.pow(10,9):"Megabyte"===s?e=n*Math.pow(10,3):"Terabyte"===s?e=n/Math.pow(10,3):"Gigabyte"===s&&(e=n):"Terabyte"===t&&("Kilobyte"===s?e=n*Math.pow(10,9):"Byte"===s?e=n*Math.pow(10,12):"Megabyte"===s?e=n*Math.pow(10,6):"Gigabyte"===s?e=n*Math.pow(10,3):"Terabyte"===s&&(e=n)),$(".upperContainer__converter .warning").hide(),""!==n&&(e=>{void 0!==e?$(".converter__result").val(e):($(".converter__result").val(""),console.log(`Error converting unit... Result value : ${e}`))})(e))}),l(".converter__remove")},h=[{label:"!1337x",desc:"1337x.to",icon:"./src/css/icons/suggestions/1337x.ico",url:"https://1337x.to/search/"},{label:"!afr",desc:"Amazon (FR)",icon:"./src/css/icons/suggestions/amazon.png",url:"https://www.amazon.fr/s?k="},{label:"!a",desc:"Amazon (US)",icon:"./src/css/icons/suggestions/amazon.png",url:"https://www.amazon.com/s?k="},{label:"!alto",desc:"AlternativeTo",icon:"./src/css/icons/suggestions/alto.ico",url:"https://alternativeto.net/browse/search?q="},{label:"!css",desc:"CSS Tricks",icon:"./src/css/icons/suggestions/csstricks.png",url:"https://css-tricks.com/?s="},{label:"!d",desc:"Download a YouTube audio stream",icon:"./src/css/icons/suggestions/download.png"},{label:"!fdroid",desc:"F-Droid",icon:"./src/css/icons/suggestions/fdroid.png",url:"https://search.f-droid.org/?q="},{label:"!g",desc:"Google",icon:"./src/css/icons/suggestions/google.png",url:"https://www.google.com/search?q="},{label:"!gh",desc:"Github",icon:"./src/css/icons/suggestions/github.ico",url:"https://github.com/search?q="},{label:"!gt",desc:"Google translate",icon:"./src/css/icons/suggestions/gt.ico",url:"https://translate.google.com/#view=home&op=translate&sl=auto&tl=en&text="},{label:"!gmap",desc:"Google Maps",icon:"./src/css/icons/suggestions/maps.ico",url:"https://www.google.be/maps/search/"},{label:"!htg",desc:"How-to Geek",icon:"./src/css/icons/suggestions/howtogeek.ico",url:"https://www.howtogeek.com/search/?q="},{label:"!iv",desc:"Invidio.us",icon:"./src/css/icons/suggestions/invidious.png",url:"https://invidio.us/search?q="},{label:"!jquery",desc:"Jquery API",icon:"./src/css/icons/suggestions/jquery.ico",url:"https://api.jquery.com/?ns0=1&s="},{label:"!jq",desc:"Jquery API",icon:"./src/css/icons/suggestions/jquery.ico",url:"https://api.jquery.com/?ns0=1&s="},{label:"!ldlc",desc:"LDLC",icon:"./src/css/icons/suggestions/ldlc.png",url:"https://www.ldlc.com/fr-be/recherche/"},{label:"!li",desc:"LinkedIn",icon:"./src/css/icons/suggestions/linkedin.ico",url:"https://www.linkedin.com/search/results/all/?keywords="},{label:"!mdn",desc:"Mozilla Developer network",icon:"./src/css/icons/suggestions/mdn.png",url:"https://developer.mozilla.org/en-US/search?q="},{label:"!pb",desc:"Pages Blanches (BE)",icon:"./src/css/icons/suggestions/pagesblanches.ico",url:"https://www.pagesblanches.be/chercher/personne/"},{label:"!os",desc:"OpenSubtitles",icon:"./src/css/icons/suggestions/opensub.ico",url:"https://www.opensubtitles.org/en/search2/sublanguageid-all/moviename-"},{label:"!osm",desc:"OpenStreetMap",icon:"./src/css/icons/suggestions/osm.png",url:"https://www.openstreetmap.org/search?query="},{label:"!owm",desc:"OpenWeatherMap",icon:"./src/css/icons/suggestions/owm.ico",url:"https://openweathermap.org/find?q="},{label:"!p",desc:"Play a Youtube audio stream or playlist",icon:"./src/css/icons/suggestions/play.svg"},{label:"!rarbg",desc:"RARBG",icon:"./src/css/icons/suggestions/rarbg.png",url:"http://rarbgmirror.org/torrents.php?search="},{label:"!rt",desc:"Rottentomatoes",icon:"./src/css/icons/suggestions/rottentomatoes.png",url:"https://www.rottentomatoes.com/search/?search="},{label:"!rtbf",desc:"RTBF",icon:"./src/css/icons/suggestions/rtbf.png",url:"https://www.rtbf.be/info/recherche?q="},{label:"!sc",desc:"SoundCloud",icon:"./src/css/icons/suggestions/soundcloud.ico",url:"https://soundcloud.com/search?q="},{label:"!so",desc:"Stack Overflow",icon:"./src/css/icons/suggestions/so.ico",url:"https://stackoverflow.com/search?q="},{label:"!torrent",desc:"Torrent9.cz",icon:"./src/css/icons/suggestions/torrent9.ico",url:"https://www.torrent9.cz/recherche/"},{label:"!translate",desc:"Google translate",icon:"./src/css/icons/suggestions/gt.ico",url:"https://translate.google.com/#view=home&op=translate&sl=auto&tl=en&text="},{label:"!uc",desc:"Unicode table",icon:"./src/css/icons/suggestions/unicode.ico",url:"https://unicode-table.com/en/search/?q="},{label:"!w",desc:"Wikipedia (EN)",icon:"./src/css/icons/suggestions/wikipedia.ico",url:"https://en.wikipedia.org/w/index.php?search="},{label:"!wfr",desc:"Wikipedia (FR)",icon:"./src/css/icons/suggestions/wikipedia.ico",url:"https://fr.wikipedia.org/w/index.php?search="},{label:"!wt",desc:"Wikitionnary (EN)",icon:"./src/css/icons/suggestions/wt.ico",url:"https://en.wiktionary.org/w/index.php?search="},{label:"!wtfr",desc:"Wikitionnary (FR)",icon:"./src/css/icons/suggestions/wt.ico",url:"https://fr.wiktionary.org/w/index.php?search="},{label:"!yarn",desc:"Yarn",icon:"./src/css/icons/suggestions/yarn.ico",url:"https://yarnpkg.com/en/packages?q="},{label:"!yt",desc:"Youtube",icon:"./src/css/icons/suggestions/yt.ico",url:"https://www.youtube.com/results?search_query="}],m=e=>{if(e.description.match(/clear sky/i))$(".forecast__weatherIcon__icon").text("☼").css({color:"yellow"});else if(e.description.match(/clouds/i))$(".forecast__weatherIcon__icon").text("☁");else if(e.description.match(/rain/i))$(".forecast__weatherIcon__icon").text("🌧");else if(e.description.match(/mist/i)){$(".forecast__weatherIcon__icon").addClass("icon flex");let e=$("<img>").attr({src:"./src/css/icons/interface/mist.svg",alt:"Mist icon"});$(".forecast__weatherIcon__icon img").length?$(".forecast__weatherIcon__icon img").replaceWith(e):e.appendTo($(".forecast__weatherIcon__icon"))}};$(".content3__container .content3").ready(()=>{$(".credits").hide(),a($("#toggleRss__Input").prop("checked")),$(".subRow").length||$("footer").css({position:"absolute",top:"90%"}),(()=>{let e={},n=$(".toggleRss__Input").prop("checked");n?$(".toggleRss__Slider").removeClass("unchecked"):$(".toggleRss__Slider").addClass("unchecked"),$("#settingsBtn").click(()=>{$(".backgroundImage, header, #mainContainer").css("filter","blur(4px)"),$(".settings__container").fadeIn().css("display","flex")}),$("#backgroundImageUploadForm__Btn").click(()=>{$("#backgroundImageUploadForm__InputFile").click()}),$("#toggleRss__Switch").click(()=>{e.RSS=$(".toggleRss__Input").prop("checked"),$(".toggleRss__Input").prop("checked")?$(".toggleRss__Slider").removeClass("unchecked"):$(".toggleRss__Slider").addClass("unchecked")}),$("#settings__child__cancelBtn").click(()=>{$(".uploadWarning").length&&$(".uploadWarning").remove(),$(".backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container").fadeOut()}),$("#settings__child__saveBtn").click(()=>{let n=!1;if(""!==$("#backgroundImageUploadForm__InputFile").val()&&""===$("#backgroundImageUploadForm__InputUrl").val()){let t=$("#backgroundImageUploadForm__InputFile").get(0).files[0];if(t.size/1048576>5)n=!0,p({type:"upload",msg:"Your file is too laaaaarge ! Please select one under 5 Mb."});else{e.backgroundImage=`./upload/${t.name}`;let n=new FormData;n.append("backgroundImageUploadInput",t,t.name),$.ajax({url:"/upload",type:"POST",data:n,processData:!1,contentType:!1,statusCode:{404:()=>{console.log("page not found !")},200:()=>{console.log("upload successfull !")}},success:t=>{$(".backgroundImage").css("backgroundImage",e.backgroundImage),$("head style").remove(),$("head").append(`<style>.formContainer__container::before {background-image: url(${e.backgroundImage});}</style>`)},error:e=>{console.log(n,t,`Error uploading file :\n${JSON.stringify(e,null,2)}`)}})}}else""===$("#backgroundImageUploadForm__InputFile").val()&&""!==$("#backgroundImageUploadForm__InputUrl").val()?$("#backgroundImageUploadForm__InputUrl").val().match(/^(http|https):\/\/(www.|)[a-zA-Z0-9\/]{1,}\.\w.+/i)&&($("#backgroundImageUploadForm__InputUrl").val().length<200?(e.backgroundImage=$("#backgroundImageUploadForm__InputUrl").val(),$(".backgroundImage").css("backgroundImage",e.backgroundImage)):(n=!0,p({type:"upload",msg:"Your URL is too large ! Please shorten it !"}))):""!==$("#backgroundImageUploadForm__InputFile").val()&&""!==$("#backgroundImageUploadForm__InputUrl").val()&&(n=!0,p({type:"upload",msg:"Hey, don't be too powerful dude ! One field at a time !"})),void 0!==e.RSS&&(!0===e.RSS?(t.emit("customization",e),location.reload()):$(".moreContent").hide()),$(".toggleRss__Input").prop("checked"),""===$("#backgroundImageUploadForm__InputFile").val()&&""===$("#backgroundImageUploadForm__InputUrl").val()&&""===$(".owmToken__input").val()&&($(".backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container").fadeOut()),$(".owmToken__input").val().match(/[a-z0-9]{32}/)&&(e.owmToken=$(".owmToken__input").val(),owmToken=$(".owmToken__input").val());$(".owmToken__Comment").text(`Your OpenWeatherMap token is ${e.owmToken}. You can update it here !`),n||($(".backgroundImage, header, #mainContainer").css("filter","none"),$(".settings__container .warning").hide(),$(".settings__container").fadeOut(),t.emit("customization",e),$(".uploadWarning").length&&$(".uploadWarning").remove())})})(),_(),c(),t.on("refresh app",()=>{location.reload()}),t.on("errorMsg",e=>{p(e)}),t.on("server settings updated",e=>{null!=e&&($(".backgroundImage").css("background-image",`url(${e.backgroundImage})`),$(".backgroundImage, header, #mainContainer").css("filter","none"),$("#settings").fadeOut())}),$("#questionBox").on("input",()=>{(e=>{let t=h.filter(t=>{const n=new RegExp(`^${e}`,"gi");return t.label.match(n)});if(e.length||(t=[],$(".suggestions").text(""),$(".formContainer").css({borderRadius:"30px",padding:"0.5% 1%"}),$(".suggestions").removeClass("active")),t!==[]&&e.length>=2&&e.startsWith("!"))if($(".formContainer").css({borderRadius:"30px 30px 0 0",paddingBottom:0}),$(".suggestions").hasClass("active")||$(".suggestions").addClass("active"),$(".suggestions").css({width:$(".formContainer").innerWidth()}),t!==[]&&t.length>0){const e=t.map(e=>`\n            <div class="suggestion flex">\n              <img class="suggestion__icon" src="${e.icon}" alt="${e.desc} icon" height="20px" />\n              <span class="suggestion__label">${e.label}</span>\n              <span class="suggestion__desc">${e.desc}</span>\n            </div>\n            `).join("");$(".suggestions").html(e),$(".suggestion").click(e=>{let t,n=e.target;"suggestion__label"===n.className?t=n.textContent:"suggestion__icon"===n.className?t=n.nextElementSibling.textContent:"suggestion__desc"===n.className?t=n.previousElementSibling.textContent:"suggestion"===n.className&&(t=n.children[1].textContent),t&&$("#questionBox").val(`${t} `).focus()})}else $(".suggestions").removeClass("active")})($("#questionBox").val())}),$("#form").keypress(e=>{13===e.keyCode&&(u(),$("#formContainer").css({padding:"0.5% 1%"}))}),$("#formSubmit").click(()=>{u()}),$("#msgContainer").text().match(/\w.+/)?d("#msgContainer"):$("#msgContainer").hide(),$(window).mousemove(e=>{mousePosition.x=e.pageX,mousePosition.y=e.pageY}),t.on("RSS status retrieved",e=>{a(e)}),$("#footer").mouseenter(()=>{$("#credits").fadeIn()}).mouseleave(()=>{$("#credits").fadeOut()})})});